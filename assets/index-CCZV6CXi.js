var A=e=>{throw TypeError(e)};var N=(e,t,n)=>t.has(e)||A("Cannot "+n);var l=(e,t,n)=>(N(e,t,"read from private field"),n?n.call(e):t.get(e)),v=(e,t,n)=>t.has(e)?A("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),I=(e,t,n,o)=>(N(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function m(e,t){return t=t||document,e.charAt(0)==="#"?t.querySelector(e):t.querySelectorAll(e)}function h(e,t,...n){const o=document.createElement(e);t&&Object.assign(o,t);for(const r of n)typeof r!="string"?o.appendChild(r):o.appendChild(document.createTextNode(r));return o}var f;class E{constructor(t,n,o){v(this,f,[]);this.rows=t,this.cols=n,this.operation=o}render(){const t=[],n=h("table",{className:"calc-table"}),o=h("tbody"),r=this.operation===c.multiply?1:0,s=65;for(let p=0;p<this.rows;p+=1){let d=`<tr data-row=${p+r} data-row-letter=${String.fromCharCode(s+p)}>`;for(let i=0;i<this.cols;i++)d+=`<td data-row=${p+r} data-col=${i+1}></td>`;d+="</tr>",t.push(d)}o.innerHTML=t.join(""),n.appendChild(o);const a=h("caption",{textContent:this.operation===c.multiply?"Tabliczka mnożenia":"Dodawanie"});return n.appendChild(a),I(this,f,Array.from(m("td",n))),n}paint(t,n){if(this.operation===c.multiply){for(const o of l(this,f))o.dataset.row<=t&&o.dataset.col<=n&&(o.style.backgroundColor="#ffaead");return}if(this.operation===c.add)for(let o=0;o<l(this,f).length;o+=1)o<t?l(this,f)[o].style.backgroundColor="#ffaead":o<t+n&&(l(this,f)[o].style.backgroundColor="#b80000");if(this.operation===c.sub)for(let o=0;o<l(this,f).length;o+=1)o<t-n?l(this,f)[o].style.backgroundColor="#ffaead":o<t&&(l(this,f)[o].style.backgroundColor="#ffd5d4")}clear(){for(const t of l(this,f))t.style.backgroundColor=""}}f=new WeakMap;var b;class k{constructor(){v(this,b,{})}add(t,n){l(this,b)[t]?(l(this,b)[t].repetitions++,n&&l(this,b)[t].correctAnswers++):l(this,b)[t]={repetitions:1,correctAnswers:n?1:0}}get(){const t=[],n=Object.entries(l(this,b));for(const o of n){const[r,{repetitions:s,correctAnswers:a}]=o;t.push([r,s,a])}return t}}b=new WeakMap;function y(e,t){return Math.floor(Math.random()*(t-e+1))+e}const L=(e,t)=>e.reduce((n,o)=>H[t](n,o)),x=()=>{const e=y(1,10),t=y(1,10);return[e,t]},O=()=>{const e=y(0,100),t=y(0,100-e);return[e,t]},B=()=>{const e=y(0,100),t=y(0,e);return[e,t]},M=(e,t)=>{let[n,o]=[0,0];switch(u.board.operation){case c.add:[n,o]=O();break;case c.sub:[n,o]=B();break;case c.multiply:[n,o]=x();break}e.value=n,t.value=o,u.clearBoard(),u.paintBoard(n,o)};function S(){const e=u.board.operation,t=h("form",{name:"equation",className:"d-inline-flex",onsubmit:d=>{d.preventDefault();const i=d.target;if(i.result.value===""){u.updateInfo();return}const w=Number(i.rows.value),$=Number(i.columns.value),C=Number(i.result.value),g=L([w,$],e)===C;u.updateHistory(g,w,$,C),u.updateResults(),i.result.value="",i.result.focus(),g&&M(r,s)}}),n={type:"number",min:0,onblur:d=>{const i=d.target;u.setActiveElementId(`#${i.id}`),setTimeout(()=>{document.activeElement.type!=="number"&&i.focus()},0)}},o={max:e===c.add||e.sub?100:10,oninput:()=>{a.value="";const d=Number(r.value),i=Number(s.value);u.clearBoard(),!(d===0||i===0)&&u.paintBoard(d,i)},...n},r=h("input",{id:"rows",name:"rows",...o}),s=h("input",{id:"columns",name:"columns",...o}),a=h("input",{id:"result",name:"result",max:e===c.add?200:100,autofocus:!0,...n}),p=h("button",{id:"check",type:"submit"},"Sprawdź wynik");return M(r,s),t.appendChild(r),t.appendChild(document.createTextNode(e)),t.appendChild(s),t.appendChild(document.createTextNode("=")),t.appendChild(a),t.appendChild(p),t}const j=(e,t,n,o,r,s)=>{const a=e[0],p=e[1],d=e[2],i=e[3],w=e[4],$=e[5],C=t+1,g=(s*100).toFixed();return`${a}${C}${p}${n}${d}${o}${i}${r}${w}${g}${$}`};function R(e){const t=[`<tr>
        <th>Lp.</th>
        <th>Działanie</th>
        <th>Powtórzenia</th>
        <th>Poprawne odpowiedzi</th>
        <th>Wynik</th>
      </tr>`];for(let o=0;o<e.length;o+=1){const[r,s,a]=e[o];t.push(j`
        <tr>
          <td>${o}</td>
          <td>${r}</td>
          <td>${s}</td>
          <td>${a}</td>
          <td>${a/s}%</td>
        <tr>
      `)}return h("table",{className:"table",innerHTML:t.join("")})}const u={stats:new k,activeElementId:"#result",counter:0,init(e){this.board=e,m("#tableContainer").replaceChildren(e.render()),m("#form").replaceChildren(S())},updateResults(){const e=this.stats.get();e.sort((n,o)=>n[2]/n[1]-o[2]/o[1]);const t=R(e);m("#results").replaceChildren(t)},updateHistory(e,t,n,o){const r=this.board.operation,s=h(e?"span":"s",{textContent:o}).outerHTML,a=`<div class=${e?"success":"error"}>${++this.counter}. ${this.updateInfo(e)} - ${t} ${r} ${n} = ${s}</div>`,p=m(".history")[0];p.innerHTML=a+p.innerHTML,this.stats.add(`${t}${r}${n}`,e)},updateInfo(e){let t="Podaj wynik!";return e!==void 0&&(t=e?"Gratulacje!":"Błąd"),m("h1")[0].textContent=t,t},clearBoard(){this.board.clear()},paintBoard(e,t){this.board.paint(e,t)},setActiveElementId(e){if(e.charAt(0)!=="#")throw new Error("Invalid id");this.activeElementId=e}},c={add:"+",sub:"−",multiply:"×"},H={[c.add]:(e,t)=>e+t,[c.sub]:(e,t)=>e-t,[c.multiply]:(e,t)=>e*t},T=(e,t)=>{switch(e){case"/dodawanie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,u.init(new E(10,10,c.add));break;case"/odejmowanie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,u.init(new E(10,10,c.sub));break;default:history.pushState({},"","./"),document.title="Matma | Tabliczka mnożenia",u.init(new E(10,10,c.multiply))}};T(window.location.pathname);m("#appMenu").addEventListener("click",e=>{e.preventDefault();const t=e.target,n=`#${document.activeElement.id}`;t.tagName==="A"&&(T(t.pathname,t.textContent),m(n).focus())});
