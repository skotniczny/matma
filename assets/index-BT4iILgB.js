var T=e=>{throw TypeError(e)};var A=(e,t,n)=>t.has(e)||T("Cannot "+n);var u=(e,t,n)=>(A(e,t,"read from private field"),n?n.call(e):t.get(e)),v=(e,t,n)=>t.has(e)?T("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),L=(e,t,n,o)=>(A(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function h(e,t){return t=t||document,e.charAt(0)==="#"?t.querySelector(e):t.querySelectorAll(e)}function f(e,t,...n){const o=document.createElement(e);t&&Object.assign(o,t);for(const r of n)typeof r!="string"?o.appendChild(r):o.appendChild(document.createTextNode(r));return o}var m;class x{constructor(){v(this,m,{})}add(t,n){u(this,m)[t]?(u(this,m)[t].repetitions++,n&&u(this,m)[t].correctAnswers++):u(this,m)[t]={repetitions:1,correctAnswers:n?1:0}}get(){const t=[],n=Object.entries(u(this,m));for(const o of n){const[r,{repetitions:s,correctAnswers:i}]=o;t.push([r,s,i])}return t}}m=new WeakMap;function g(e,t){return Math.floor(Math.random()*(t-e+1))+e}const O=(e,t)=>e.reduce((n,o)=>R[t](n,o)),I=()=>{const e=g(1,10),t=g(1,10);return[e,t]},j=()=>{const e=g(0,100),t=g(0,100-e);return[e,t]},M=(e,t,n)=>{let[o,r]=[0,0];switch(e.board.operation){case l.add:[o,r]=j();break;case l.multiply:[o,r]=I();break}t.value=o,n.value=r,e.board.clear(),e.board.paint(o,r)};function k(e){const t=e.board.operation,n=f("form",{name:"equation",className:"d-inline-flex",onsubmit:c=>{c.preventDefault();const d=c.target;if(d.result.value===""){e.updateInfo();return}const w=Number(d.rows.value),$=Number(d.columns.value),C=Number(d.result.value),E=O([w,$],t)===C;e.updateHistory(E,w,$,C),e.updateResults(),d.result.value="",d.result.focus(),E&&M(e,s,i)}}),o={type:"number",min:0,onblur:c=>{setTimeout(()=>{document.activeElement.type!=="number"&&c.target.focus()},0)}},r={max:t===l.add?100:10,oninput:()=>{a.value="";const c=Number(s.value),d=Number(i.value);e.board.clear(),!(c===0||d===0)&&e.board.paint(c,d)},...o},s=f("input",{id:"rows",name:"rows",...r}),i=f("input",{id:"columns",name:"columns",...r}),a=f("input",{id:"result",name:"result",max:t===l.add?200:100,autofocus:!0,...o}),b=f("button",{id:"check",type:"submit"},"Sprawdź wynik");return M(e,s,i),n.appendChild(s),n.appendChild(document.createTextNode(t)),n.appendChild(i),n.appendChild(document.createTextNode("=")),n.appendChild(a),n.appendChild(b),n}const H=(e,t,n,o,r,s)=>{const i=e[0],a=e[1],b=e[2],c=e[3],d=e[4],w=e[5],$=t+1,C=(s*100).toFixed();return`${i}${$}${a}${n}${b}${o}${c}${r}${d}${C}${w}`};function P(e){const t=[`<tr>
        <th>Lp.</th>
        <th>Działanie</th>
        <th>Powtórzenia</th>
        <th>Poprawne odpowiedzi</th>
        <th>Wynik</th>
      </tr>`];for(let o=0;o<e.length;o+=1){const[r,s,i]=e[o];t.push(H`
        <tr>
          <td>${o}</td>
          <td>${r}</td>
          <td>${s}</td>
          <td>${i}</td>
          <td>${i/s}%</td>
        <tr>
      `)}return f("table",{className:"table",innerHTML:t.join("")})}const y={stats:new x,counter:0,init(e){this.board=e,h("#tableContainer").replaceChildren(y.board.render()),h("#form").replaceChildren(k(y))},updateResults(){const e=this.stats.get();e.sort((n,o)=>n[2]/n[1]-o[2]/o[1]);const t=P(e);h("#results").replaceChildren(t)},updateHistory(e,t,n,o){const r=this.board.operation,s=f(e?"span":"s",{textContent:o}).outerHTML,i=`<div class=${e?"success":"error"}>${++this.counter}. ${this.updateInfo(e)} - ${t} ${r} ${n} = ${s}</div>`,a=h(".history")[0];a.innerHTML=i+a.innerHTML,this.stats.add(`${t}${r}${n}`,e)},updateInfo(e){let t="Podaj wynik!";return e!==void 0&&(t=e?"Gratulacje!":"Błąd"),h("h1")[0].textContent=t,t}},l={add:"+",multiply:"×"},R={[l.add]:(e,t)=>e+t,[l.multiply]:(e,t)=>e*t};var p;class N{constructor(t,n,o){v(this,p,[]);this.rows=t,this.cols=n,this.operation=o}render(){const t=[],n=f("table",{className:"calc-table"}),o=f("tbody"),r=this.operation===l.multiply?1:0,s=65;for(let a=0;a<this.rows;a+=1){let b=`<tr data-row=${a+r} data-row-letter=${String.fromCharCode(s+a)}>`;for(let c=0;c<this.cols;c++)b+=`<td data-row=${a+r} data-col=${c+1}></td>`;b+="</tr>",t.push(b)}o.innerHTML=t.join(""),n.appendChild(o);const i=f("caption",{textContent:this.operation===l.multiply?"Tabliczka mnożenia":"Dodawanie"});return n.appendChild(i),L(this,p,Array.from(h("td",n))),n}paint(t,n){if(this.operation===l.multiply){for(const o of u(this,p))o.dataset.row<=t&&o.dataset.col<=n&&(o.style.backgroundColor="#ffaead");return}if(this.operation===l.add)for(let o=0;o<u(this,p).length;o+=1)o<t?u(this,p)[o].style.backgroundColor="#ffaead":o<t+n&&(u(this,p)[o].style.backgroundColor="#b80000")}clear(){for(const t of u(this,p))t.style.backgroundColor=""}}p=new WeakMap;y.init(new N(10,10,l.multiply));h("#appMenu").addEventListener("click",e=>{e.preventDefault();const t=e.target,n=`#${document.activeElement.id}`;if(t.tagName!=="A")return;const o=t.pathname;o==="/"&&(history.pushState({},"","./"),document.title="Matma | Tabliczka mnożenia",y.init(new N(10,10,l.multiply))),o==="/dodawanie"&&(history.pushState({},"","./dodawanie"),document.title="Matma | Dodawanie",y.init(new N(10,10,l.add))),h(n).focus()});
