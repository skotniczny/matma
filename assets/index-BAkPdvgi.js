var A=e=>{throw TypeError(e)};var N=(e,t,n)=>t.has(e)||A("Cannot "+n);var d=(e,t,n)=>(N(e,t,"read from private field"),n?n.call(e):t.get(e)),v=(e,t,n)=>t.has(e)?A("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),I=(e,t,n,o)=>(N(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function m(e,t){return t=t||document,e.charAt(0)==="#"?t.querySelector(e):t.querySelectorAll(e)}function h(e,t,...n){const o=document.createElement(e);t&&Object.assign(o,t);for(const r of n)typeof r!="string"?o.appendChild(r):o.appendChild(document.createTextNode(r));return o}var f;class E{constructor(t,n,o){v(this,f,[]);this.rows=t,this.cols=n,this.operation=o}render(){const t=[],n=h("table",{className:"calc-table"}),o=h("tbody"),r=this.operation===a.multiply?1:0,s=65;for(let p=0;p<this.rows;p+=1){let u=`<tr data-row=${p+r} data-row-letter=${String.fromCharCode(s+p)}>`;for(let i=0;i<this.cols;i++)u+=`<td data-row=${p+r} data-col=${i+1}></td>`;u+="</tr>",t.push(u)}o.innerHTML=t.join(""),n.appendChild(o);const c=h("caption",{textContent:H[this.operation]});return n.appendChild(c),I(this,f,Array.from(m("td",n))),n}paint(t,n){if(this.operation===a.multiply){for(const o of d(this,f))o.dataset.row<=t&&o.dataset.col<=n&&(o.style.backgroundColor="#ffaead");return}if(this.operation===a.add)for(let o=0;o<d(this,f).length;o+=1)o<t?d(this,f)[o].style.backgroundColor="#ffaead":o<t+n&&(d(this,f)[o].style.backgroundColor="#b80000");if(this.operation===a.sub)for(let o=0;o<d(this,f).length;o+=1)o<t-n?d(this,f)[o].style.backgroundColor="#ffaead":o<t&&(d(this,f)[o].style.backgroundColor="#ffd5d4")}clear(){for(const t of d(this,f))t.style.backgroundColor=""}}f=new WeakMap;var b;class k{constructor(){v(this,b,{})}add(t,n){d(this,b)[t]?(d(this,b)[t].repetitions++,n&&d(this,b)[t].correctAnswers++):d(this,b)[t]={repetitions:1,correctAnswers:n?1:0}}get(){const t=[],n=Object.entries(d(this,b));for(const o of n){const[r,{repetitions:s,correctAnswers:c}]=o;t.push([r,s,c])}return t}}b=new WeakMap;function y(e,t){return Math.floor(Math.random()*(t-e+1))+e}const L=(e,t)=>e.reduce((n,o)=>P[t](n,o)),x=()=>{const e=y(1,10),t=y(1,10);return[e,t]},O=()=>{const e=y(0,100),t=y(0,100-e);return[e,t]},j=()=>{const e=y(0,100),t=y(0,e);return[e,t]},M=(e,t)=>{let[n,o]=[0,0];switch(l.board.operation){case a.add:[n,o]=O();break;case a.sub:[n,o]=j();break;case a.multiply:[n,o]=x();break}e.value=n,t.value=o,l.clearBoard(),l.paintBoard(n,o)};function B(){const e=l.board.operation,t=h("form",{name:"equation",className:"d-inline-flex",onsubmit:u=>{u.preventDefault();const i=u.target;if(i.result.value===""){l.updateInfo();return}const w=Number(i.rows.value),$=Number(i.columns.value),C=Number(i.result.value),g=L([w,$],e)===C;l.updateHistory(g,w,$,C),l.updateResults(),i.result.value="",i.result.focus(),g&&M(r,s)}}),n={type:"number",min:0,onblur:u=>{const i=u.target;l.setActiveElementId(`#${i.id}`),setTimeout(()=>{document.activeElement.type!=="number"&&i.focus()},0)}},o={max:e===a.add||e.sub?100:10,oninput:()=>{c.value="";const u=Number(r.value),i=Number(s.value);l.clearBoard(),!(u===0||i===0)&&l.paintBoard(u,i)},...n},r=h("input",{id:"rows",name:"rows",...o}),s=h("input",{id:"columns",name:"columns",...o}),c=h("input",{id:"result",name:"result",max:e===a.add?200:100,autofocus:!0,...n}),p=h("button",{id:"check",type:"submit"},"Sprawdź wynik");return M(r,s),t.appendChild(r),t.appendChild(document.createTextNode(e)),t.appendChild(s),t.appendChild(document.createTextNode("=")),t.appendChild(c),t.appendChild(p),t}const S=(e,t,n,o,r,s)=>{const c=e[0],p=e[1],u=e[2],i=e[3],w=e[4],$=e[5],C=t+1,g=(s*100).toFixed();return`${c}${C}${p}${n}${u}${o}${i}${r}${w}${g}${$}`};function R(e){const t=[`<tr>
        <th>Lp.</th>
        <th>Działanie</th>
        <th>Powtórzenia</th>
        <th>Poprawne odpowiedzi</th>
        <th>Wynik</th>
      </tr>`];for(let o=0;o<e.length;o+=1){const[r,s,c]=e[o];t.push(S`
        <tr>
          <td>${o}</td>
          <td>${r}</td>
          <td>${s}</td>
          <td>${c}</td>
          <td>${c/s}%</td>
        <tr>
      `)}return h("table",{className:"table",innerHTML:t.join("")})}const l={stats:new k,activeElementId:"",counter:0,init(e){this.board=e,m("#tableContainer").replaceChildren(e.render()),m("#form").replaceChildren(B())},updateResults(){const e=this.stats.get();e.sort((n,o)=>n[2]/n[1]-o[2]/o[1]);const t=R(e);m("#results").replaceChildren(t)},updateHistory(e,t,n,o){const r=this.board.operation,s=h(e?"span":"s",{textContent:o}).outerHTML,c=`<div class=${e?"success":"error"}>${++this.counter}. ${this.updateInfo(e)} - ${t} ${r} ${n} = ${s}</div>`,p=m(".history")[0];p.innerHTML=c+p.innerHTML,this.stats.add(`${t}${r}${n}`,e)},updateInfo(e){let t="Podaj wynik!";return e!==void 0&&(t=e?"Gratulacje!":"Błąd"),m("h1")[0].textContent=t,t},clearBoard(){this.board.clear()},paintBoard(e,t){this.board.paint(e,t)},setActiveElementId(e){if(typeof e!="string"||e.charAt(0)!=="#")throw new Error("Invalid id");this.activeElementId=e}},a={add:"+",sub:"−",multiply:"×"},H={[a.multiply]:"Tabliczka mnożenia",[a.add]:"Dodawanie",[a.sub]:"Odejmowanie"},P={[a.add]:(e,t)=>e+t,[a.sub]:(e,t)=>e-t,[a.multiply]:(e,t)=>e*t},T=(e,t)=>{switch(e){case"/dodawanie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,l.init(new E(10,10,a.add));break;case"/odejmowanie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,l.init(new E(10,10,a.sub));break;default:history.pushState({},"","./"),document.title="Matma | Tabliczka mnożenia",l.init(new E(10,10,a.multiply))}l.activeElementId&&m(l.activeElementId).focus()};T("/"+window.location.pathname.split("/").pop());m("#appMenu").addEventListener("click",e=>{e.preventDefault();const t=e.target;t.tagName==="A"&&T(t.pathname,t.textContent)});
