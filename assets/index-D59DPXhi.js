var A=e=>{throw TypeError(e)};var N=(e,t,n)=>t.has(e)||A("Cannot "+n);var u=(e,t,n)=>(N(e,t,"read from private field"),n?n.call(e):t.get(e)),E=(e,t,n)=>t.has(e)?A("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),I=(e,t,n,r)=>(N(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function b(e,t){return t=t||document,e.charAt(0)==="#"?t.querySelector(e):t.querySelectorAll(e)}function m(e,t,...n){const r=document.createElement(e);t&&Object.assign(r,t);for(const o of n)typeof o!="string"?r.appendChild(o):r.appendChild(document.createTextNode(o));return r}var f;class g{constructor(t,n,r){E(this,f,[]);this.rows=t,this.cols=n,this.operation=r}render(){const t=[],n=m("table",{className:"calc-table"}),r=m("tbody"),o=this.operation===i.multiply||this.operation===i.div?1:0,s=65;for(let p=0;p<this.rows;p+=1){let l=`<tr data-row=${p+o} data-row-letter=${String.fromCharCode(s+p)}>`;for(let a=0;a<this.cols;a++)l+=`<td data-row=${p+o} data-col=${a+1}></td>`;l+="</tr>",t.push(l)}r.innerHTML=t.join(""),n.appendChild(r);const c=m("caption",{textContent:B[this.operation]});return n.appendChild(c),I(this,f,Array.from(b("td",n))),n}paint(t,n){if(this.operation===i.multiply){for(const r of u(this,f))r.dataset.row<=t&&r.dataset.col<=n&&(r.style.backgroundColor="#ffaead");return}if(this.operation===i.div){const r=t/n;for(const o of u(this,f))o.dataset.row<=r&&o.dataset.col<=n&&(o.style.backgroundColor=o.dataset.col>1?"#ffaead":"#b80000");return}if(this.operation===i.add){const r=t+n;for(let o=0;o<r;o+=1)o<t?u(this,f)[o].style.backgroundColor="#ffaead":o<r&&(u(this,f)[o].style.backgroundColor="#b80000");return}if(this.operation===i.sub){const r=t-n;for(let o=0;o<t;o+=1)o<r?u(this,f)[o].style.backgroundColor="#ffaead":o<t&&(u(this,f)[o].style.backgroundColor="#ffd5d4")}}clear(){for(const t of u(this,f))t.style.backgroundColor=""}}f=new WeakMap;var y;class L{constructor(){E(this,y,{})}add(t,n){u(this,y)[t]?(u(this,y)[t].repetitions++,n&&u(this,y)[t].correctAnswers++):u(this,y)[t]={repetitions:1,correctAnswers:n?1:0}}get(){const t=[],n=Object.entries(u(this,y));for(const r of n){const[o,{repetitions:s,correctAnswers:c}]=r;t.push([o,s,c])}return t}}y=new WeakMap;const k=(e,t)=>e.reduce((n,r)=>R[t](n,r)),M=(e,t)=>{const n=S[d.board.operation],[r,o]=n();e.value=r,t.value=o,d.clearBoard(),d.paintBoard(r,o)};function O(){const e=d.board.operation,t=m("form",{name:"equation",className:"d-inline-flex",onsubmit:l=>{l.preventDefault();const a=l.target;if(a.result.value===""){d.updateInfo();return}const w=Number(a.rows.value),$=Number(a.columns.value),C=Number(a.result.value),v=k([w,$],e)===C;d.updateHistory(v,w,$,C),d.updateResults(),a.result.value="",a.result.focus(),v&&M(o,s)}}),n={type:"number",min:0,onblur:l=>{const a=l.target;d.setActiveElementId(`#${a.id}`),setTimeout(()=>{document.activeElement.type!=="number"&&a.focus()},0)}},r={max:e===i.add||e.sub?100:10,oninput:()=>{c.value="";const l=Number(o.value),a=Number(s.value);d.clearBoard(),!(l===0||a===0)&&d.paintBoard(l,a)},...n},o=m("input",{id:"rows",name:"rows",...r}),s=m("input",{id:"columns",name:"columns",...r}),c=m("input",{id:"result",name:"result",max:e===i.add?200:100,autofocus:!0,...n}),p=m("button",{id:"check",type:"submit"},"Sprawdź wynik");return M(o,s),t.appendChild(o),t.appendChild(document.createTextNode(e)),t.appendChild(s),t.appendChild(document.createTextNode("=")),t.appendChild(c),t.appendChild(p),t}const j=(e,t,n,r,o,s)=>{const c=e[0],p=e[1],l=e[2],a=e[3],w=e[4],$=e[5],C=t+1,v=(s*100).toFixed();return`${c}${C}${p}${n}${l}${r}${a}${o}${w}${v}${$}`};function x(e){const t=[`<tr>
        <th>Lp.</th>
        <th>Działanie</th>
        <th>Powtórzenia</th>
        <th>Poprawne odpowiedzi</th>
        <th>Wynik</th>
      </tr>`];for(let r=0;r<e.length;r+=1){const[o,s,c]=e[r];t.push(j`
        <tr>
          <td>${r}</td>
          <td>${o}</td>
          <td>${s}</td>
          <td>${c}</td>
          <td>${c/s}%</td>
        <tr>
      `)}return m("table",{className:"table",innerHTML:t.join("")})}function h(e,t){return Math.floor(Math.random()*(t-e+1))+e}const d={stats:new L,activeElementId:"",counter:0,init(e){this.board=e,b("#tableContainer").replaceChildren(e.render()),b("#form").replaceChildren(O())},updateResults(){const e=this.stats.get();e.sort((n,r)=>n[2]/n[1]-r[2]/r[1]);const t=x(e);b("#results").replaceChildren(t)},updateHistory(e,t,n,r){const o=this.board.operation,s=m(e?"span":"s",{textContent:r}).outerHTML,c=`<div class=${e?"success":"error"}>${++this.counter}. ${this.updateInfo(e)} - ${t} ${o} ${n} = ${s}</div>`,p=b(".history")[0];p.innerHTML=c+p.innerHTML,this.stats.add(`${t}${o}${n}`,e)},updateInfo(e){let t="Podaj wynik!";return e!==void 0&&(t=e?"Gratulacje!":"Błąd"),b("h1")[0].textContent=t,t},clearBoard(){this.board.clear()},paintBoard(e,t){this.board.paint(e,t)},setActiveElementId(e){if(typeof e!="string"||e.charAt(0)!=="#")throw new Error("Invalid id");this.activeElementId=e}},i={add:"+",sub:"−",multiply:"×",div:"÷"},B={[i.multiply]:"Tabliczka mnożenia",[i.add]:"Dodawanie",[i.sub]:"Odejmowanie",[i.div]:"Dzielenie"},R={[i.add]:(e,t)=>e+t,[i.sub]:(e,t)=>e-t,[i.multiply]:(e,t)=>e*t,[i.div]:(e,t)=>e/t},S={[i.add]:()=>{const e=h(0,100),t=h(0,100-e);return[e,t]},[i.sub]:()=>{const e=h(0,100),t=h(0,e);return[e,t]},[i.multiply]:()=>{const e=h(1,10),t=h(1,10);return[e,t]},[i.div]:()=>{const e=h(1,10),t=h(1,10);return[e*t,t]}},T=(e,t)=>{switch(e){case"/dodawanie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,d.init(new g(10,10,i.add));break;case"/odejmowanie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,d.init(new g(10,10,i.sub));break;case"/dzielenie":history.pushState({},"",`.${e}`),document.title=`Matma | ${t}`,d.init(new g(10,10,i.div));break;default:history.pushState({},"","./"),document.title="Matma | Tabliczka mnożenia",d.init(new g(10,10,i.multiply))}d.activeElementId&&b(d.activeElementId).focus()};T("/"+window.location.pathname.split("/").pop());b("#appMenu").addEventListener("click",e=>{e.preventDefault();const t=e.target;t.tagName==="A"&&T(t.pathname,t.textContent)});
